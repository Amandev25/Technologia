# Conversational Bot

A comprehensive conversational AI bot that helps users practice speaking in different scenarios with real-time speech-to-text, text-to-speech, and detailed conversation analysis.

## Features

- **LLM-Powered Conversations:**
  - Dynamic responses generated by Google Gemini 2.0 Flash
  - Contextual understanding of conversation history
  - Natural, human-like interactions
  - Scenario-specific behavior and tone

- **Three Conversation Scenarios:**
  - Returning a Defective Item (Polite)
  - Coffee Shop Conversation (Casual)
  - Manager and Developer Meeting (Formal)

- **Real-time Speech Processing:**
  - Speech-to-Text using AssemblyAI
  - Text-to-Speech using Murf AI
  - Audio recording and playback

- **Comprehensive Analysis:**
  - Grammar analysis and error detection
  - Pronunciation error identification
  - Professional language assessment
  - Fluency analysis
  - Detailed improvement suggestions

- **Report Generation:**
  - JSON reports with detailed analysis
  - Human-readable summary reports
  - Conversation audio recording

## Web Interface Features

The Streamlit web interface provides a modern, user-friendly experience:

### ðŸŽ¨ **Modern UI/UX**
- **Responsive design** that works on desktop and mobile
- **Color-coded scoring** (green/orange/red based on performance)
- **Interactive elements** with hover effects and animations
- **Sidebar navigation** with quick actions and help
- **Professional styling** with custom CSS

### ðŸ’¬ **Conversation Interface**
- **Real-time conversation flow** with chat-like interface
- **Text input** for immediate responses
- **Audio input placeholder** (ready for future implementation)
- **Conversation history** with timestamps
- **Visual message bubbles** (user vs. bot messages)

### ðŸ“Š **Real-time Analysis**
- **Live conversation tracking** with automatic analysis
- **Instant feedback** on grammar, pronunciation, and professional language
- **Score visualization** with color-coded performance indicators
- **Detailed error reporting** with specific suggestions

### ðŸ“‹ **Comprehensive Reports**
- **Overall performance score** (0-100 scale)
- **Detailed breakdown** by category
- **Improvement recommendations** tailored to each scenario
- **Downloadable reports** in multiple formats (JSON, TXT)

## Installation

1. **Install Python dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

2. **Install PyAudio (if needed):**
   - **Windows:** `pip install pyaudio`
   - **macOS:** `brew install portaudio && pip install pyaudio`
   - **Linux:** `sudo apt-get install python3-pyaudio`

3. **Set up API Keys:**
   
   Create a `.env` file in the `converstational_bot/` directory:
   
   ```env
   # Google Gemini API Key (Required for LLM responses)
   GEMINI_API_KEY=your_gemini_api_key_here
   
   # AssemblyAI API Key (for Speech-to-Text)
   ASSEMBLYAI_API_KEY=your_assemblyai_key_here
   
   # Murf AI API Key (for Text-to-Speech)
   MURF_API_KEY=your_murf_key_here
   ```
   
   **Get your Gemini API key:**
   - Visit [Google AI Studio](https://makersuite.google.com/app/apikey)
   - Sign in and create an API key
   - Copy it to the `.env` file

## Usage

### Quick Start

#### Option 1: Web Interface (Recommended)
```bash
# Install dependencies
pip install -r requirements.txt

# Launch the web interface
python run_ui.py
# OR
streamlit run streamlit_app.py
```

#### Option 2: Command Line Interface
```bash
python conversational_bot.py
```

### Testing Components

Test individual components:
```bash
# Test LLM integration
python test_llm.py

# Test report generation (if test_bot.py exists)
# python test_bot.py
```

### Using Individual Modules

#### Conversation Manager
```python
from conversation_manager import ConversationManager

manager = ConversationManager()
initial_message = manager.start_conversation("defective_item")
response = manager.generate_response("I want to return this item")
report = manager.get_conversation_report()
```

#### Audio Processor
```python
from audio_processor import AudioProcessor

processor = AudioProcessor()
processor.start_listening(callback_function)
audio_file = processor.speak_text("Hello, how can I help you?")
```

#### Report Generator
```python
from report_generator import ReportGenerator

generator = ReportGenerator()
report = generator.analyze_conversation(conversation_data)
summary = generator.generate_summary_report(report)
```

## Conversation Scenarios

### 1. Returning a Defective Item (Polite)
- **Context:** Customer service interaction
- **Focus:** Polite language, persuasion, empathy
- **Suggestions:** Use "I would appreciate" instead of "I want"

### 2. Coffee Shop Conversation (Casual)
- **Context:** Barista-customer interaction
- **Focus:** Friendly service language, recommendations
- **Suggestions:** Use "beverage" instead of "drink"

### 3. Manager and Developer Meeting (Formal)
- **Context:** Professional business meeting
- **Focus:** Technical language, formal communication
- **Suggestions:** Use "I would like to discuss" instead of "Let's talk about"

## Analysis Features

### Grammar Analysis
- Subject-verb agreement
- Common grammatical errors
- Punctuation and capitalization
- Sentence structure

### Pronunciation Analysis
- Common mispronunciations
- Difficult sound patterns
- STT error detection
- Pronunciation scoring

### Professional Language Assessment
- Casual vs. professional language
- Politeness enhancement
- Scenario-specific suggestions
- Business communication skills

### Fluency Analysis
- Words per message
- Sentence variety
- Communication flow
- Overall fluency scoring

## Report Structure

### Basic Conversation Report
```json
{
  "scenario": "Returning a Defective Item (Polite)",
  "conversation_duration": "5 minutes 30 seconds",
  "total_exchanges": 6,
  "conversation_history": [...],
  "pronunciation_analysis": {...},
  "grammar_analysis": {...},
  "improvement_suggestions": [...],
  "overall_assessment": "..."
}
```

### Detailed Analysis Report
```json
{
  "conversation_metadata": {...},
  "grammar_analysis": {
    "total_errors": 3,
    "error_rate": 0.5,
    "grammar_score": 85
  },
  "pronunciation_analysis": {
    "total_pronunciation_errors": 2,
    "pronunciation_score": 90
  },
  "professional_language_analysis": {
    "casual_language_usage": [...],
    "professional_score": 75
  },
  "fluency_analysis": {
    "avg_words_per_message": 12.5,
    "fluency_score": 80
  },
  "improvement_recommendations": [...],
  "detailed_feedback": [...]
}
```

## File Structure

```
conversational_bot/
â”œâ”€â”€ conversational_bot.py         # Main bot application (CLI)
â”œâ”€â”€ streamlit_app.py             # Web interface (Streamlit)
â”œâ”€â”€ run_ui.py                    # UI launcher script
â”œâ”€â”€ conversation_manager.py       # Conversation logic (uses LLM)
â”œâ”€â”€ llm_manager.py               # LLM integration (Gemini)
â”œâ”€â”€ audio_processor.py            # STT/TTS integration
â”œâ”€â”€ report_generator.py           # Analysis and reporting
â”œâ”€â”€ config.py                    # Configuration and API keys
â”œâ”€â”€ test_llm.py                  # LLM integration tests
â”œâ”€â”€ requirements.txt             # Python dependencies
â”œâ”€â”€ env.example                  # Example environment file
â”œâ”€â”€ README.md                    # This file
â”œâ”€â”€ LLM_INTEGRATION_GUIDE.md     # LLM integration documentation
â”œâ”€â”€ STREAMLIT_README.md          # Web interface documentation
â”œâ”€â”€ INTEGRATION_SUMMARY.md       # Integration overview
â”œâ”€â”€ streaming.py                 # Original STT implementation
â””â”€â”€ text_to_speech.py            # Original TTS implementation
```

## Configuration

### Audio Settings
- Sample Rate: 16kHz
- Channels: 1 (mono)
- Format: 16-bit PCM
- Buffer Size: 800 frames (50ms)

### API Configuration
- AssemblyAI: WebSocket streaming STT
- Murf AI: High-quality TTS with multiple voices

## Troubleshooting

### Common Issues

1. **PyAudio Installation:**
   - Use conda: `conda install pyaudio`
   - Or use pre-compiled wheels

2. **Microphone Access:**
   - Check system permissions
   - Ensure microphone is not in use by other applications

3. **API Errors:**
   - Verify API keys are correct
   - Check internet connection
   - Ensure API quotas are not exceeded

4. **Audio Playback:**
   - Install pygame for better audio playback
   - Check system audio settings

### Error Messages

- `Error opening microphone stream`: Check microphone permissions and availability
- `STT Error`: Verify AssemblyAI API key and connection
- `Error generating speech`: Check Murf AI API key and quota

## Development

### Adding New Scenarios
1. Add scenario to `ConversationManager.scenario_contexts`
2. Implement response generation logic
3. Add scenario-specific analysis rules

### Extending Analysis
1. Add new grammar rules to `ReportGenerator.grammar_rules`
2. Implement new analysis methods
3. Update scoring algorithms

### Customizing TTS/STT
1. Modify `AudioProcessor` class
2. Update API configurations
3. Add new voice options

## License

This project is for educational and personal use. Please respect the terms of service for the APIs used (AssemblyAI, Murf AI).

## Contributing

1. Fork the repository
2. Create a feature branch
3. Add tests for new functionality
4. Submit a pull request

## Support

For issues and questions:
1. Check the troubleshooting section
2. Run the test suite to identify problems
3. Review API documentation for external services
